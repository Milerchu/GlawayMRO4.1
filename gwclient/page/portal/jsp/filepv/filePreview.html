<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">

	<head>
		<title>绿荫服务网站内部员工门户</title>
		<meta http-equiv="X-UA-Compatible" content="IE=EmulateIE7 charset=utf-8" />
		<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
		<script type="text/javascript" src="js/jquery.js"></script>
		<script type="text/javascript" src="officecontrol/OfficeContorlFunctions.js" charset="utf-8"></script>

	</head>

	<!-- <body onload='intializePage("doc/11111.docx")'> -->
	<body onload='intializePage("D:/MRO/DOCLINKS/ATTACHMENTS/201808/NTKO OFFICE文档控件BS应用开发原理及架构.pdf")'>
		<script type="text/javascript" src="officecontrol/ntkoofficecontrol.js" charset="utf-8"></script>
		<div id=statusBar style="height:20px;width:100%;background-color:#c0c0c0;font-size:12px;"></div>
		<script language="JScript" for=TANGER_OCX event="OnDocumentClosed()">
			setFileOpenedOrClosed(false);
		</script>
		<script language="JScript" for="TANGER_OCX" event="OnDocumentOpened(TANGER_OCX_str,TANGER_OCX_obj)">
			OFFICE_CONTROL_OBJ.Menubar = false;
			OFFICE_CONTROL_OBJ.IsShowToolMenu = false;
			OFFICE_CONTROL_OBJ.IsShowEditMenu = false;
			//OFFICE_CONTROL_OBJ.Toolbars = false;
			OFFICE_CONTROL_OBJ.SetReadOnly(true);
			//获取文档控件中打开的文档的文档类型
			switch(OFFICE_CONTROL_OBJ.doctype) {
				case 1:
					fileType = "Word.Document";
					fileTypeSimple = "wrod";
					break;
				case 2:
					fileType = "Excel.Sheet";
					fileTypeSimple = "excel";
					break;
				case 3:
					fileType = "PowerPoint.Show";
					fileTypeSimple = "ppt";
					break;
				case 4:
					fileType = "Visio.Drawing";
					break;
				case 5:
					fileType = "MSProject.Project";
					break;
				case 6:
					fileType = "WPS Doc";
					fileTypeSimple = "wps";
					break;
				case 7:
					fileType = "Kingsoft Sheet";
					fileTypeSimple = "et";
					break;
				default:
					fileType = "unkownfiletype";
					fileTypeSimple = "unkownfiletype";
			}
			setFileOpenedOrClosed(true);
		</script>
		<script language="JScript" for=TANGER_OCX event="BeforeOriginalMenuCommand(TANGER_OCX_str,TANGER_OCX_obj)">
			alert("BeforeOriginalMenuCommand事件被触发");
		</script>
		<script language="JScript" for=TANGER_OCX event="OnFileCommand(TANGER_OCX_str,TANGER_OCX_obj)">
			if(TANGER_OCX_str == 3) {
				//alert("不能保存！");
				//saveWjnr();
				CancelLastCommand = true;
			}
		</script>
		<script language="JScript" for=TANGER_OCX event="AfterPublishAsPDFToURL(result,code)">
			result = trim(result);
			alert(result);
			document.all("statusBar").innerHTML = "服务器返回信息:" + result;
			if(result == "文档保存成功。") {
				window.close();
			}
		</script>
		<script language="JScript" for=TANGER_OCX event="OnCustomMenuCmd2(menuPos,submenuPos,subsubmenuPos,menuCaption,menuID)">
			alert("第" + menuPos + "," + submenuPos + "," + subsubmenuPos + "个菜单项,menuID=" + menuID + ",菜单标题为\"" + menuCaption + "\"的命令被执行.");
		</script>
		</div>

		<object classid="clsid:916EE952-83C7-485f-8469-69D975889ED2" codebase="officecontrol/ntkopdfdoc.cab#version=4,0,0,2" width="100%" height="100%"> 
							</object>
	</body>

</html>